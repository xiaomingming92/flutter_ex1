# çœŸæœºè°ƒè¯•é…ç½®æŒ‡å—

## ğŸ¯ çœŸæœºè°ƒè¯•é…ç½®æ¦‚è¿°

å½“Android Emulatoræ–‡ä»¶é€‰æ‹©åŠŸèƒ½å—é™ï¼Œæˆ–éœ€è¦è¿›è¡ŒçœŸå®ç¯å¢ƒæµ‹è¯•æ—¶ï¼ŒçœŸæœºè°ƒè¯•æ˜¯æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚æœ¬æŒ‡å—å°†è¯¦ç»†è¯´æ˜å¦‚ä½•é…ç½®é¡¹ç›®ä»¥è¿›è¡ŒçœŸæœºè°ƒè¯•ã€‚

## ğŸ“‹ ç¯å¢ƒé…ç½®è¦æ±‚

### ç½‘ç»œç¯å¢ƒè¦æ±‚
- Androidæ‰‹æœºå’Œå¼€å‘ç”µè„‘éœ€è¦åœ¨**åŒä¸€WiFiç½‘ç»œ**å†…
- ç¡®ä¿WiFiç½‘ç»œç¨³å®šï¼Œé¿å…é¢‘ç¹æ–­è¿
- å»ºè®®ä½¿ç”¨2.4GHz WiFiä»¥è·å¾—æ›´å¥½çš„å…¼å®¹æ€§

### ç³»ç»Ÿç‰ˆæœ¬è¦æ±‚
- Android 6.0+ (API Level 23+)
- Flutter 3.0+
- ç”µè„‘ç«¯å®‰è£…Android SDK Platform Tools

## ğŸ”§ é…ç½®æ­¥éª¤

### æ­¥éª¤1ï¼šè·å–å¼€å‘ç”µè„‘IPåœ°å€

æ ¹æ®å½“å‰ç”µè„‘é…ç½®ï¼Œä½ çš„IPåœ°å€ä¸ºï¼š`192.168.0.210`

**è·å–IPçš„æ–¹æ³•ï¼š**
```bash
# Windows
ipconfig | grep -E "IPv4" | grep -v "127.0.0.1"

# æˆ–è€…ä½¿ç”¨ PowerShell
Get-NetIPAddress -AddressFamily IPv4 | Where-Object {$_.InterfaceAlias -like "*WiFi*"} | Select-Object InterfaceAlias, IPAddress
```

### æ­¥éª¤2ï¼šä¿®æ”¹.env.testé…ç½®æ–‡ä»¶

å‚è€ƒï¼š<mcfile name=".env.test" path="c:\Users\xmm\studioProjects\ex1\.env.test" startline="2" endline="6"></mcfile>
```bash
# å°†10.0.2.2æ›¿æ¢ä¸ºä½ çš„ç”µè„‘IPåœ°å€
BASE_URL=http://192.168.0.210:3000/api
ENV_NAME=TEST
SUCCESS_CODE=200
```

**é…ç½®è¯´æ˜ï¼š**
- `BASE_URL`ï¼šæœåŠ¡å™¨åœ°å€ï¼ˆæ‰‹æœºå°†è®¿é—®è¿™ä¸ªåœ°å€ï¼‰
- `ENV_NAME`ï¼šç¯å¢ƒåç§°ï¼ˆç”¨äºæ ‡è¯†æµ‹è¯•ç¯å¢ƒï¼‰
- `SUCCESS_CODE`ï¼šAPIæˆåŠŸå“åº”ç ï¼ˆé€šå¸¸æ˜¯200ï¼‰

### æ­¥éª¤3ï¼šå¯åŠ¨æœ¬åœ°æœåŠ¡å™¨

**ä½¿ç”¨Node.jså¯åŠ¨æœ¬åœ°APIæœåŠ¡å™¨ï¼š**
```bash
# è¿›å…¥æœåŠ¡å™¨ç›®å½•ï¼ˆæ ¹æ®ä½ çš„é¡¹ç›®ç»“æ„è°ƒæ•´ï¼‰
cd /path/to/your/api/server
npm install
npm run dev
# æˆ–è€…
npm start
```

**æˆ–è€…ä½¿ç”¨å…¶ä»–æœåŠ¡å™¨ï¼š**
```bash
# Python FlaskæœåŠ¡å™¨
python app.py

# PHPå†…ç½®æœåŠ¡å™¨
php -S 192.168.0.210:3000

# ç®€å•çš„HTTPæœåŠ¡å™¨
python -m http.server 3000
```

### æ­¥éª¤4ï¼šè¿æ¥çœŸæœºè¿›è¡Œè°ƒè¯•

**å¯åŠ¨Flutteråº”ç”¨ï¼š**
```bash
fvm flutter run -d <device_id> --dart-define=test
```

**è·å–å¯ç”¨è®¾å¤‡åˆ—è¡¨ï¼š**
```bash
fvm flutter devices
```

**ç¤ºä¾‹å®Œæ•´å‘½ä»¤ï¼š**
```bash
# æŸ¥çœ‹è®¾å¤‡
fvm flutter devices

# å¯åŠ¨è°ƒè¯•ï¼ˆå°†device_idæ›¿æ¢ä¸ºå®é™…è®¾å¤‡IDï¼‰
fvm flutter run -d <device_id> --dart-define=test
```

## ğŸ“± AndroidçœŸæœºè®¾ç½®

### å¼€å‘è€…é€‰é¡¹è®¾ç½®

1. **å¯ç”¨å¼€å‘è€…æ¨¡å¼**
   - è®¾ç½® â†’ å…³äºæ‰‹æœº â†’ è¿ç»­ç‚¹å‡»"ç‰ˆæœ¬å·"7æ¬¡
   - è¿”å›è®¾ç½®ï¼Œæ‰¾åˆ°"å¼€å‘è€…é€‰é¡¹"

2. **USBè°ƒè¯•è®¾ç½®**
   - å¼€å‘è€…é€‰é¡¹ â†’ å¼€å¯"USBè°ƒè¯•"
   - å»ºè®®åŒæ—¶å¼€å¯"USBè°ƒè¯•(å®‰å…¨è®¾ç½®)"

3. **ç½‘ç»œè°ƒè¯•ï¼ˆå¯é€‰ï¼Œæ›´æ–¹ä¾¿ï¼‰**
   - å¼€å‘è€…é€‰é¡¹ â†’ å¼€å¯"é€šè¿‡USBè°ƒè¯•å®‰è£…ADB"
   - è¿æ¥WiFiåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ˜¾ç¤ºç½‘ç»œADBè¿æ¥åœ°å€

### çœŸæœºè°ƒè¯•éªŒè¯

**éªŒè¯ç½‘ç»œè¿æ¥ï¼š**
```bash
# æ£€æŸ¥æ‰‹æœºæ˜¯å¦è¿æ¥åˆ°åŒä¸€ç½‘ç»œ
adb devices

# å¦‚æœç½‘ç»œè°ƒè¯•å·²å¯ç”¨ï¼Œå¯ä»¥æŸ¥çœ‹æ— çº¿è¿æ¥
adb connect 192.168.0.210:5555
```

**æµ‹è¯•APIè¿é€šæ€§ï¼š**
```bash
# åœ¨æ‰‹æœºä¸Šæµè§ˆå™¨ä¸­è®¿é—®ï¼ˆå°†IPåœ°å€æ›¿æ¢ä¸ºå®é™…IPï¼‰
http://192.168.0.210:3000/api/health
```

## ğŸ”§ é«˜çº§é…ç½®

### å¤šç¯å¢ƒå¿«é€Ÿåˆ‡æ¢è„šæœ¬

**åˆ›å»ºè°ƒè¯•å¯åŠ¨è„šæœ¬ï¼š** `scripts/debug_phone.bat`
```bash
@echo off
echo Starting Flutter debugging on phone...

REM è·å–æœ¬æœºIP
for /f "tokens=2 delims=:" %%a in ('ipconfig ^| findstr /i "IPv4" ^| findstr /v "127.0.0.1"') do set IP=%%a
set IP=%IP: =%

echo Your IP address: %IP%
echo Please update .env.test with: BASE_URL=http://%IP%:3000/api

REM åˆ—å‡ºå¯ç”¨è®¾å¤‡
echo Available devices:
fvm flutter devices

REM å¯åŠ¨è°ƒè¯•
set /p DEVICE_ID="Enter device ID: "
fvm flutter run -d %DEVICE_ID% --dart-define=test
pause
```

### VS Codeé…ç½®

**åˆ›å»ºè°ƒè¯•é…ç½®ï¼š** `.vscode/launch.json`
```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Flutter: çœŸæœºè°ƒè¯•",
      "type": "dart",
      "request": "launch",
      "program": "lib/main.dart",
      "args": [
        "--dart-define=test"
      ],
      "deviceId": "your-device-id-here"
    },
    {
      "name": "Flutter: çœŸæœºè°ƒè¯•(æŒ‡å®šè®¾å¤‡)",
      "type": "dart", 
      "request": "launch",
      "program": "lib/main.dart",
      "args": [
        "--dart-define=test"
      ],
      "deviceId": "${input:deviceId}"
    }
  ],
  "inputs": [
    {
      "id": "deviceId",
      "description": "é€‰æ‹©è°ƒè¯•è®¾å¤‡",
      "default": "",
      "type": "promptString"
    }
  ]
}
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. æ— æ³•è¿æ¥åˆ°çœŸæœº
**é—®é¢˜æè¿°ï¼š** `adb devices` æ— è®¾å¤‡æ˜¾ç¤º

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# é‡å¯ADBæœåŠ¡
adb kill-server
adb start-server

# æ£€æŸ¥USBè¿æ¥
adb devices -l

# å¦‚æœä»æ— æ•ˆï¼Œå°è¯•ç½‘ç»œè°ƒè¯•
adb connect <phone-ip>:5555
```

#### 2. APIæ— æ³•è®¿é—®
**é—®é¢˜æè¿°ï¼š** çœŸæœºæ— æ³•è®¿é—®æœ¬åœ°APIæœåŠ¡å™¨

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼Œç¡®ä¿3000ç«¯å£å¼€æ”¾
- ç¡®è®¤æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€WiFiç½‘ç»œ
- æµ‹è¯•APIç«¯ç‚¹ï¼š`curl http://192.168.0.210:3000/api/health`

#### 3. æƒé™é—®é¢˜
**é—®é¢˜æè¿°ï¼š** çœŸæœºæƒé™æ‹’ç»

**è§£å†³æ–¹æ¡ˆï¼š**
- æ‰‹åŠ¨æˆæƒUSBè°ƒè¯•
- åœ¨å¼€å‘è€…é€‰é¡¹ä¸­æ¸…é™¤USBè°ƒè¯•æˆæƒå¹¶é‡æ–°è¿æ¥
- æ£€æŸ¥Androidç‰ˆæœ¬å¯¹åº”çš„æƒé™é…ç½®

#### 4. ç½‘ç»œä¸ç¨³å®š
**é—®é¢˜æè¿°ï¼š** è°ƒè¯•è¿‡ç¨‹ä¸­ç½‘ç»œé¢‘ç¹æ–­å¼€

**è§£å†³æ–¹æ¡ˆï¼š**
- ä½¿ç”¨æœ‰çº¿ç½‘ç»œè¿æ¥ï¼ˆæ›´ç¨³å®šï¼‰
- ç¡®ä¿WiFiä¿¡å·å¼ºåº¦è‰¯å¥½
- è€ƒè™‘ä½¿ç”¨ç½‘ç»œADBè°ƒè¯•

### è°ƒè¯•æŠ€å·§

#### å®æ—¶ç½‘ç»œç›‘æ§
```bash
# ç›‘æ§APIè¯·æ±‚
fvm flutter logs | grep "API"

# æŸ¥çœ‹è¯¦ç»†ç½‘ç»œè¯·æ±‚
adb logcat | grep -E "(Dio|Network|Http)"
```

#### ç¯å¢ƒå˜é‡éªŒè¯
åœ¨åº”ç”¨ä¸­éªŒè¯ç¯å¢ƒé…ç½®ï¼š
```dart
void checkEnvironment() {
  print('Environment: ${Env.current.envName}');
  print('Base URL: ${Env.current.baseUrl}');
  print('Success Code: ${Env.current.sucessCode}');
}
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### ç½‘ç»œä¼˜åŒ–
1. **ä½¿ç”¨å±€åŸŸç½‘IPåœ°å€**è€Œélocalhost
2. **å¯ç”¨HTTP/2**ï¼ˆå¦‚æœæœåŠ¡å™¨æ”¯æŒï¼‰
3. **é…ç½®è¯·æ±‚è¶…æ—¶**ï¼š
```dart
 Dio dio = Dio(BaseOptions(
   connectTimeout: Duration(seconds: 10),
   receiveTimeout: Duration(seconds: 10),
 ));
```

### çœŸæœºè°ƒè¯•ä¼˜åŒ–
1. **ä½¿ç”¨Releaseæ¨¡å¼**è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼š
```bash
fvm flutter run --release --dart-define=test
```

2. **å¯ç”¨çƒ­é‡è½½**ï¼š
```bash
fvm flutter run --hot --dart-define=test
```

## ğŸ¯ çœŸæœºè°ƒè¯•æ£€æŸ¥æ¸…å•

- [ ] ç¡®è®¤æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€WiFiç½‘ç»œ
- [ ] å¼€å‘è€…é€‰é¡¹å·²å¯ç”¨USBè°ƒè¯•
- [ ] .env.testé…ç½®æ–‡ä»¶å·²æ›´æ–°IPåœ°å€
- [ ] æœ¬åœ°APIæœåŠ¡å™¨å·²å¯åŠ¨å¹¶ç›‘å¬æ­£ç¡®ç«¯å£
- [ ] ADBèƒ½æ£€æµ‹åˆ°çœŸæœºè®¾å¤‡
- [ ] æµ‹è¯•APIè¿é€šæ€§
- [ ] Flutteråº”ç”¨èƒ½æ­£å¸¸å¯åŠ¨
- [ ] ç½‘ç»œè¯·æ±‚èƒ½æ­£å¸¸å‘é€å’Œæ¥æ”¶

é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œä½ å¯ä»¥æœ‰æ•ˆåœ°è¿›è¡ŒçœŸæœºè°ƒè¯•ï¼Œç‰¹åˆ«é€‚ç”¨äºæ–‡ä»¶é€‰æ‹©ã€ç›¸æœºåŠŸèƒ½ç­‰éœ€è¦çœŸå®ç¡¬ä»¶ç¯å¢ƒçš„æµ‹è¯•åœºæ™¯ã€‚